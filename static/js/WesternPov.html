
<html lang="en">
    <head>
        <meta charset = "utf-8">
        <title> Amazing Bar Chart</title>
        <script type="text/javascript" src="/home/shikongle/Desktop/Y/D3/project/d3.v3.js"></script>
        <style type="text/css">
                /* This is where your CSS will go */
        </style>
    </head>

    <body>
        <p>Please Click to Update my Dear!</p>
        <p><button id="10">10</button><button id="20">20</button><button id="30">30</button></p>
        <p> Then click on the "transition below to initiate the transition</p>

        <script type = "text/javascript">

            //Width and height
            var w = 600;
            var h = 250;

            //On click, update with new data    
                        
            var dataset = [5, 10, 13, 19, 21, 25, 22, 18, 15, 13, 11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];

            //Ordinal scale to handle left/right positioning
            var xScale = d3.scale.ordinal()
                                .domain(d3.range(dataset.length))
                                .rangeRoundBands([0, w], 0.05);
            
            var yScale = d3.scale.linear()
                                .domain([0, d3.max(dataset)])
                                .range([0, h]);
            //Create SVG element
            var svg = d3.select("body")
                        .append("svg")
                        .attr("width", w)
                        .attr("height", h);

           //Create bars
            svg.selectAll("rect")
                .data(dataset)
                .enter()
                .append("rect")
                .attr("x", function(d, i) {
                        return xScale(i);
                })
                .attr("y", function(d) {
                    return h - yScale(d);
                })
                .attr("width", xScale.rangeBand())
                .attr("height", function(d) {
                    return yScale(d);
                })
                .attr("fill", function(d) {
                    return "rgb(0, 0, " + (d * 10) + ")";
                });
            
            //Create labels
            svg.selectAll("text")
                .data(dataset)
                .enter()
                .append("text")
                .text(function(d) {
                    return d;
                })
                .attr("text-anchor", "middle")
                .attr("x", function(d, i) {
                    return xScale(i) + xScale.rangeBand() / 2;
                })
                .attr("y", function(d) {
                    return h - yScale(d) + 14;
                })
                .attr("font-family", "sans-serif")
                .attr("font-size", "11px")
                .attr("fill", "white");

        // Set dataset based on button
        d3.selectAll("button")
        .on("click", function() {
            var number_of_data_points = this.getAttribute("id");
            if (number_of_data_points == "10") {
                dataset = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13 ];
                new_dataset = [11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];

            } else if (number_of_data_points == "20") {
                dataset = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13, 
                                    11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];
                new_dataset = [ 11, 12, 15, 20, 18, 17, 16, 18, 23, 25,
                                                        5, 10, 13, 19, 21, 25, 22, 18, 15, 13 ];

            } else if (number_of_data_points == "30") {
                dataset = [5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
                                        11, 12, 15, 20, 18, 17, 16, 18, 23, 25,
                                        25, 16, 10, 18, 19, 14, 11, 15, 18, 19 ];
                new_dataset = [25, 16, 10, 18, 19, 14, 11, 15, 18, 19, 
                                                5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
                                                11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];
            }  
            d3.selectAll("svg").remove();

                xScale = d3.scale.ordinal()
                            .domain(d3.range(dataset.length))
                            .rangeRoundBands([0, w], 0.05);

                yScale = d3.scale.linear()
                            .domain([0, d3.max(dataset)])
                            .range([0, h]);

                //Create SVG element
                svg = d3.select("body")
                            .append("svg")
                            .attr("width", w)
                            .attr("height", h);

                //Create Bars
                svg.selectAll("rect")
                            .data(dataset)
                            .enter()
                            .append("rect")
                            .attr("x", function(d, i) {
                                    return xScale(i);
                            })
                            .attr("y", function(d) {
                                    return h - yScale(d);
                            })
                            .attr("width", xScale.rangeBand())
                            .attr("height", function(d) {
                                        return yScale(d);
                            })
                            .attr("fill", function(d) {
                                    return "rgb(0,0 " + (d * 10) + ")";
                            });
                                                        
                    // Create labels
                    svg.selectAll("text")
                        .data(dataset)
                        .enter()
                        .append("text")
                        .text(function(d) {
                            return d;
                        })
                        .attr("text-anchor", "middle")
                        .attr("x", function(d, i) {
                            return xScale(i) + xScale.rangeBand() / 2;
                        })
                        .attr("y", function(d) {
                            return h -yScale(d) + 14;
                        })
                        .attr("font-family", "sans-serif")
                        .attr("font-size", "11px")
                        .attr("fill", "white");
                        });

                    //On click, update with new data
                    d3.select("input")
                    .on("click", function() {
                            //New values for dataset
                            dataset = [ 11, 12, 15, 20, 18, 17, 16, 18, 23, 25,
                                            5, 10, 13, 19, 21, 25, 22, 18, 15, 13 ];
                            //Update all rects
                            svg.selectAll("rect")
                                .data(new_dataset)
                                .transition()
                                .delay(function(d, i) {
                                    return i / dataset.length * 1000;
                                })
                                .duration(500)
                                .attr("y", function(d) {
                                    return h - yScale(d);
                                })
                                .attr("height", function(d) {
                                    return yScale(d);
                                })
                                .attr("fill", function(d) {
                                    return "rgb(0, 0, " + (d * 10) + ")";

                                });

                            //Update all labels
                            svg.selectAll("text")
                                .data(new_dataset)
                                .transition()
                                .delay(function(d, i) {
                                        return i/ dataset.length * 1000;
                                })
                                .duration(500)
                                .text(function(d) {
                                        return d;
                                })
                                .attr("x", function(d, i) {
                                        return xScale(i) + xScale.rangeBand() / 2;
                                })
                                .attr("y", function(d) {
                                        return h - yScale(d) + 14;
                                });
                                    
                        });                                       
        </script>
    </body>
</html>





        
